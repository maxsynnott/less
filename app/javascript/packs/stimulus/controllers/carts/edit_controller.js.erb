import { Controller } from "stimulus"

export default class extends Controller {
	checkout(event) {
		event.preventDefault()

		fetch(routes.new_stripe_checkout_path())
		.then(response => response.json())
		.then((data) => {
			const stripe = Stripe('pk_test_Y2HGxcv4B58lA5tEakifsdiC00JK3c15ec');

			if (data.error) {
				console.log("Error! ", data.error)
			} else {
				stripe.redirectToCheckout({
				  sessionId: data.session_id
				}).then((result) => {
				  // Improve error logging
				  console.log(result.error.message)
				});
			}
		})
	}
}
