import { Controller } from "stimulus"

export default class extends Controller {
	static targets = ["form", "scheduledAt"]

	connect() {
		const dates = []

		<% Delivery.available_dates.map(&:to_s).each do |date| %>
			dates.push("<%= date %>")
		<% end %>

		flatpickr(this.scheduledAtTarget, {
			altInput: true,
			enable: dates
		})
	}

	submitForm(event) {
		event.preventDefault()
		
		fetch(routes.api_v1_orders_path(), { 
			method: "POST",
			body: new FormData(this.formTarget)
		})
		.then(response => response.json())
		.then((data) => {
			console.log(data)
		})
	}
}
