import { Controller } from "stimulus"

export default class extends Controller {
	connect() {
		this.stripe = Stripe('pk_test_Y2HGxcv4B58lA5tEakifsdiC00JK3c15ec');

		this.confirmCardPayment()
	}

	confirmCardPayment() {
		this.stripe
			.confirmCardPayment(this.data.get('clientSecret'), {
				return_url: window.location.origin + routes.order_path({ id: this.data.get("orderId") })
			})
			.then((result) => {
				if (result.error) {
					console.log(result.error)
				} else {
					window.location.href = routes.order_path({ id: this.data.get("orderId") })
					console.log(result.paymentIntent)
				}
			})
	}
}
